{% extends 'base.html' %}
{% block title %}تولیدکننده QR{% endblock %}
{% block content %}
<div class="max-w-3xl mx-auto px-4 py-16">
  <h1 class="text-3xl font-extrabold">تولید QR</h1>
  <p class="mt-2 text-slate-600">این کد را به مشتری نشان دهید تا اسکن کند.</p>
  <div class="mt-8 grid md:grid-cols-2 gap-6 items-center">
    <div>
      <label class="text-sm text-slate-600">شناسه کسب‌وکار</label>
      <input id="biz" class="mt-2 w-full px-3 py-2 border rounded-md" placeholder="1" value="{% if business %}{{ business.id }}{% endif %}" />
      <label class="mt-4 block text-sm text-slate-600">امتیاز</label>
      <input id="amt" class="mt-2 w-full px-3 py-2 border rounded-md" placeholder="1" value="1" />
      <button onclick="gen()" class="mt-4 px-4 py-2 bg-primary text-white rounded-md">تولید</button>
    </div>
    <div class="p-6 border rounded-2xl">
      <img id="qr" class="w-64 h-64 mx-auto" />
      <p class="mt-3 text-center text-sm text-slate-500" id="payload"></p>
    </div>
  </div>
</div>
<script>
  function gen(){
    const biz = document.getElementById('biz').value || '1';
    const amt = document.getElementById('amt').value || '1';
    const payload = JSON.stringify({ business_id: parseInt(biz), amount: parseInt(amt) });
    document.getElementById('payload').innerText = payload;
    const dataUrl = 'https://api.qrserver.com/v1/create-qr-code/?size=256x256&data=' + encodeURIComponent(payload);
    document.getElementById('qr').src = dataUrl;
  }
</script>
{% endblock %}


